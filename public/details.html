<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DEMO Transaction Details - Educational Purpose Only</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body class="details-page">
    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>Loading Transaction Details...</p>
        </div>
    </div>

    <div class="details-container" id="detailsContent" style="display: none;">
        <div class="details-header">
            <button class="back-btn" onclick="goBack()">
                <svg width="24" height="24" fill="white" viewBox="0 0 24 24">
                    <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.42-1.41L7.83 13H20v-2z"/>
                </svg>
            </button>
            <h1>Transaction Details</h1>
            <div class="profile-icon">
                <svg width="24" height="24" fill="#4fd2b2" viewBox="0 0 24 24">
                    <path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9V7L15 6.5V7.5C15 8.3 14.3 9 13.5 9H10.5C9.7 9 9 8.3 9 7.5V6.5L3 7V9H21Z"/>
                </svg>
            </div>
        </div>

        <div class="bank-icon">
            <svg width="60" height="60" viewBox="0 0 60 60">
                <rect x="10" y="20" width="40" height="30" rx="5" fill="#9333ea"/>
                <rect x="15" y="15" width="30" height="20" rx="3" fill="white" opacity="0.9"/>
                <circle cx="30" cy="25" r="3" fill="#9333ea"/>
            </svg>
        </div>

        <div class="transfer-info">
            <h2>Transfer to <span id="recipientName">DEMO USER</span></h2>
            <div class="amount-large" id="detailsAmount">‚Ç¶100.00</div>
            <div class="status-success">Successful</div>
        </div>

        <div class="progress-steps">
            <div class="step completed">
                <div class="step-icon">‚úì</div>
                <div class="step-text">
                    <div class="step-title">Payment successful</div>
                    <div class="step-time" id="paymentTime">09-02 15:37:16</div>
                </div>
            </div>
            <div class="step completed">
                <div class="step-icon">‚úì</div>
                <div class="step-text">
                    <div class="step-title">Processing by bank</div>
                    <div class="step-time" id="processingTime">09-02 15:37:16</div>
                </div>
            </div>
            <div class="step completed">
                <div class="step-icon">‚úì</div>
                <div class="step-text">
                    <div class="step-title">Received by bank</div>
                    <div class="step-time" id="receivedTime">09-02 15:37:44</div>
                </div>
            </div>
        </div>

        <div class="disclaimer">
            The recipient account is expected to be credited within 5 minutes, subject to notification by the bank. If you have any questions, you can also <span class="contact-link">contact the recipient bank üôãüèª</span>
        </div>

        <div class="transaction-summary">
            <div class="summary-row">
                <span class="label">Amount</span>
                <span class="value" id="summaryAmount">‚Ç¶100.00</span>
            </div>
            <div class="summary-row">
                <span class="label">Fee</span>
                <span class="value strikethrough">‚Ç¶10.00</span>
                <span class="value">‚Ç¶0.00</span>
            </div>
            <div class="summary-row total">
                <span class="label">Amount Paid</span>
                <span class="value" id="totalAmount">‚Ç¶100.00</span>
            </div>
        </div>

        <div class="transaction-details">
            <h3>Transaction Details</h3>
            
            <div class="detail-row">
                <span class="label">Recipient Details</span>
                <span class="value" id="recipientDetails">DEMO USER<br>DemoBank | 1234567890</span>
            </div>
            
            <div class="detail-row">
                <span class="label">Transaction No.</span>
                <span class="value" id="transactionNo">DEMO123456789üìã</span>
            </div>
            
            <div class="detail-row">
                <span class="label">Payment Method</span>
                <span class="value">Wallet -‚Ç¶81.00 ><br>OWealth -‚Ç¶19.00 ></span>
            </div>
            
            <div class="detail-row">
                <span class="label">Transaction Date</span>
                <span class="value" id="transactionDate">Sep 2nd, 2025 15:37:16</span>
            </div>
            
            <div class="detail-row">
                <span class="label">Session ID</span>
                <span class="value" id="sessionId">100042509021437241402499380260üìã</span>
            </div>
        </div>

        <div class="more-actions">
            <h4>More Actions</h4>
            <div class="action-row">
                <span class="label">Category</span>
                <span class="value">Transfer ></span>
            </div>
        </div>

        <div class="bottom-actions">
            <button class="report-btn">Report Issue</button>
            <button class="share-btn">Share Receipt</button>
        </div>
    </div>

    <script>
        // Show loading for 4 seconds then show content
        setTimeout(() => {
            document.getElementById('loadingOverlay').style.display = 'none';
            document.getElementById('detailsContent').style.display = 'block';
            
            // Load and display transaction data
            fetch('/api/transaction-data')
                .then(response => response.json())
                .then(data => {
                    updateDetailsDisplay(data);
                })
                .catch(error => {
                    console.error('Error loading transaction data:', error);
                    window.location.href = '/';
                });
        }, 4000);

        function updateDetailsDisplay(data) {
            const amount = parseFloat(data.amount).toLocaleString('en-NG', {
                style: 'currency',
                currency: 'NGN'
            });

            // Update recipient name
            document.getElementById('recipientName').textContent = data.accountName.toUpperCase();
            
            // Update amounts
            document.getElementById('detailsAmount').textContent = amount;
            document.getElementById('summaryAmount').textContent = amount;
            document.getElementById('totalAmount').textContent = amount;
            
            // Update recipient details
            document.getElementById('recipientDetails').innerHTML = 
                `${data.accountName.toUpperCase()}<br>${data.bankName} | ${data.accountNumber}`;
            
            // Update transaction number
            document.getElementById('transactionNo').textContent = `${data.referenceNumber}üìã`;
            
            // Update transaction date
            const transactionDate = new Date(data.transactionDate);
            const formattedDate = transactionDate.toLocaleDateString('en-US', {
                month: 'short',
                day: 'numeric',
                year: 'numeric'
            }) + ' ' + transactionDate.toLocaleTimeString('en-US', {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            });
            document.getElementById('transactionDate').textContent = formattedDate;
            
            // Update session ID
            document.getElementById('sessionId').textContent = `${data.referenceNumber}${Math.random().toString(36).substr(2, 15).toUpperCase()}üìã`;
            
            // Update timestamps (simulated)
            const baseTime = new Date(data.transactionDate);
            document.getElementById('paymentTime').textContent = formatTimestamp(baseTime);
            document.getElementById('processingTime').textContent = formatTimestamp(new Date(baseTime.getTime() + 1000));
            document.getElementById('receivedTime').textContent = formatTimestamp(new Date(baseTime.getTime() + 28000));
        }

        function formatTimestamp(date) {
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            const day = date.getDate().toString().padStart(2, '0');
            const hours = date.getHours().toString().padStart(2, '0');
            const minutes = date.getMinutes().toString().padStart(2, '0');
            const seconds = date.getSeconds().toString().padStart(2, '0');
            return `${month}-${day} ${hours}:${minutes}:${seconds}`;
        }

        function goBack() {
            // Show loading overlay
            document.getElementById('loadingOverlay').style.display = 'flex';
            document.getElementById('detailsContent').style.display = 'none';
            
            // Navigate after 4 seconds
            setTimeout(() => {
                window.location.href = '/receipt';
            }, 4000);
        }
    </script>
</body>
</html>